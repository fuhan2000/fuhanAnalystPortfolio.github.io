<!DOCTYPE HTML>
<!--
	Massively by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Binary Classification Autos Books</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Header -->
					<header id="header">
						<a href="index.html" class=""></a>
					</header>

				<!-- Nav -->
					<nav id="nav">
						<ul class="links">
							<li><a href="index.html">Portfolio Main Page</a></li>

						</ul>
						<ul class="icons">
							<li><a href="https://www.linkedin.com/in/fuhhanchang/" class="icon brands alt fa-linkedin"><span class="label">linkedin</span></a></li>
							<li><a href="https://github.com/fuhan2000" class="icon brands alt fa-github"><span class="label">GitHub</span></a></li>
						</ul>
					</nav>

				<!-- Main -->
					<div id="main">

						<!-- Post -->
							<section class="post">
								<header class="major">
									
									<h1>Binary Classification using LSTM in Tensorflow
										</h1>
									<p>This program classify whether a customer's comment is about autos(0) or books(1)</p>
								</header>

								<div class="image main"><img src="images/automobile_books/automobile_books.png" alt="" /></div>
								<p>Suppose Amazon put me in charge of the twitter feed of autos and books' review. My job is to classify whether a customer is commenting about automotive or books.
									I write this program to help me in my task.
								</p>


								<h2>data source</h2>
								<figure style="max-width:2388pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="images/automobile_books/data_src.png" alt=""></div></figure>
								<p>My raw data comes from Jianmo Ni of UCSD. Click <a href="https://nijianmo.github.io/amazon/index.html">here</a> for more details. 
									The automotive and books data are downloaded from the links highlighted in orange.</p>. 

								<p>The data comes in the form of json.gz file and his website provides helpful code to extract the necessary data. </p>

								<h2>Importing data</h2>
								<figure style="max-width:2388pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="images/automobile_books/df2.png" alt=""></div></figure>
								<p>We start off by importing 10,000 lines of books data into df2. reviewText contain the customer comments.</p>

								<figure style="max-width:2388pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="images/automobile_books/numw.png" alt=""></div></figure>
								<figure style="max-width:2388pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="images/automobile_books/numw2.png" alt=""></div></figure>
								<p>We keep track of the number of words in reviewText. I am only interested in those rows where customer enter at least two words. 
									The reasoning being that if it is just a single word comment (e.g., good), even a human has difficulty classifying that comment.</p>

								<figure style="max-width:2388pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="images/automobile_books/df1.png" alt=""></div></figure>
								<p>We download the automotive data into df1.</p>
								<figure style="max-width:2388pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="images/automobile_books/df1_2.png" alt=""></div></figure>
								<p>Again we only keep those rows whose comments have more than two words. We now have 9530 rows for df1 (automotive) and 9694 rows for df2(books).  </p>

								<h2>text Preprocessing</h2>
								<p>Only minimal preprocessing in the form of lower-case, removing special characters and removing multiple spaces was done. </p>
								<figure style="max-width:2388pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="images/automobile_books/lower.png" alt=""></div></figure>
								<p>We change all text to lower-case</p>
								<figure style="max-width:2388pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="images/automobile_books/rm_spe_mul.png" alt=""></div></figure>
								<p>We then remove all the special characters and multiple spaces in reviewText. </p>
								<figure style="max-width:2388pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="images/automobile_books/both_df.png" alt=""></div></figure>
								<p>Both df1 and df2 reviewText has at least two words per row. </p>

								<figure style="max-width:2388pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="images/automobile_books/df1_df2.png" alt=""></div></figure>
								<p>We assign class 0 for auto and class 1 for books. As we no longer need num_words, we will drop it. </p>

								<h2>Combining data frame</h2>
								<figure style="max-width:2388pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="images/automobile_books/df_csv.png" alt=""></div></figure>
								<p>Here we joined df1 and df2 into df. This has a shape of (19224,2). df has 9530 rows from df1 and 9694 rows from df2.</p>

								<h2>Wordcloud </h2>
								<figure style="max-width:2388pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="images/automobile_books/wordcloud.png" alt=""></div></figure>
								<p>texts1 will contain the string of auto comments. texts2 book comments.</p>

								<h2>wordcloud for automotive</h2>
								<figure style="max-width:2388pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="images/automobile_books/wc_auto.png" alt=""></div></figure>
								<p>use, car and work are commonly use in automotive comments.</p>

								<h2>wordcloud for books</h2>
								<figure style="max-width:2388pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="images/automobile_books/wc_book.png" alt=""></div></figure>
								<p>book, read and one are commonly used. </p>

								<h2>creating the gensim word2vec model</h2>
								<figure style="max-width:2388pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="images/automobile_books/small_y.png" alt=""></div></figure>
								<p>y will be made of the 0 and 1 from class. </p>

								<figure style="max-width:2388pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="images/automobile_books/gensim.png" alt=""></div></figure>
								<p>X will be a list of list of comments. w2v_model is defined in DIM to have a array of 100 vectors per word. 
									I defined a window of 10 and my min_count of 1. More details on word2vec <a href="https://radimrehurek.com/gensim/models/word2vec.html">here</a>. 
									My w2v_model's vocabulary is 44794.
								</p>

								<h2>Import tensorflow tokenizer</h2>
								<figure style="max-width:2388pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="images/automobile_books/token.png" alt=""></div></figure>
								<p>We import some libraries from tensorflow and sklearn. We do a fit_on_texts() on X. 
									We then do a texts_to_sequences() such that X will be a list of list of sequence of number. For example in X[0], 1,31,82 will each represent a word.  </p>

								<figure style="max-width:2388pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="images/automobile_books/plt_histo.png" alt=""></div></figure>
								<p>Out of 19224 rows of comments, only 31 rows have comments that exceed 1000 words.</p>
								<figure style="max-width:2388pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="images/automobile_books/word_index.png" alt=""></div></figure>
								<p>Notice the word_index start from 1. </p>
								<figure style="max-width:2388pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="images/automobile_books/pad_seq.png" alt=""></div></figure>
								<p>We will take into consideration the first 1000 words. If there is fewer words than this, we will pad it with pad_sequences. This is a requirement of tensorflow. 
									As word_index start from 1, we need to add one in vocab_size. This is to get it to play nice with get_weight_matrix().</p>
								<figure style="max-width:2388pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="images/automobile_books/enbedd.png" alt=""></div></figure>
								<p>We initialize weight_matrix with np.zeros. weight_matrix will be an array of vectors. An element in this array will represent one word. 
									model.wv[word] will vectorized the word (using gensim) and the result will be stored in weight_matrix[i] where i will be an integer equal to or greater than one. </p>

								<h2>Initialize Sequential model</h2>
								<figure style="max-width:2388pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="images/automobile_books/seq_model.png" alt=""></div></figure>
								<p>We pass vocab_size, DIM, embedding_vectors, maxlen to add(). We will use activation='sigmoid' for this binary classification. There are other options available 
									but for now, we will just stick with these.</p>
								
								<h2>Train test Split</h2>
								<figure style="max-width:2388pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="images/automobile_books/train_test.png" alt=""></div></figure>
								<p>We do our train_test_split(). In fit(), we have 0.9699 training accuracy and 0.9623 validation accuracy.</p>

								<h2>Metrics</h2>
								<figure style="max-width:2388pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="images/automobile_books/y_pred.png" alt=""></div></figure>
								<p>Test accuracy is almost 0.96. Overall F1 is 0.96. tn = 2277, fp = 87 (1.8% of test size), fn =108 (2.2% of test size), tp = 2334. 
									test size = 4806 (25% of 19224 rows in df). This is a good model.</p>

								<h2>Prediction for book</h2>
								<figure style="max-width:2388pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="images/automobile_books/pred_books.png" alt=""></div></figure>
								<p>In both cases, the model can correctly predict book category(1).</p>

								<h2>Prediction for auto</h2>
								<figure style="max-width:2388pxpx" class="w-richtext-align-fullwidth w-richtext-figure-type-image"><div><img src="images/automobile_books/pred_autos.png" alt=""></div></figure>
								<p>Model make correct prediction for autos(0). </p>

								<h2>Conclusion</h2>
								<p>This is a good model.</p>
							</section>

					</div>

				<!-- Footer -->
					<footer id="footer">
						<nav id="nav">
							<ul class="links">
								<li><a href="index.html">Portfolio Main Page</a></li>
	
							</ul>
						</nav>

						<section class="split contact">




						</section>
					</footer>

				<!-- Copyright -->
					<div id="copyright">
						<ul><li>&copy; fuhan</li></ul>
					</div>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>